function Ui(a){this._viewportClass=a.viewportClass,this._layerClass=a.layerClass,this._controlsClass=a.controlsClass,this._enableControls=a.enableControls}function Model(a){}function Controller(a){this._buttons=a.buttons}function Block(a,b){this._className=a,this._window=this.create(b)}function Button(a,b){this._buttons=a,this._links=this.getLinks(this._buttons),this._func=b||function(){console.log("no function binded!")}}function Controls(a,b,c,d){this._className=a,this._wrapper=this.createWrapper(b),this._links=this.getLinks(c),this._left=this.createButton("left"),this._right=this.createButton("right"),this._buttons=$(this._wrapper).children(),this.currentIndex=d}function getHeight(a){return Math.max($(a).height(),$(a).outerHeight())}function getWidth(a){return Math.max($(a).width(),$(a).outerWidth())}!function(a){a.fn.ajaxLoader=function(b){var c={viewportClass:"tw-ajax-viewport",layerClass:"tw-ajax-layer",controlsClass:"tw-ajax-controls",buttons:".buttons",enableControls:!0},d=this,e={};return e.init=function(){this.settings=a.extend({},c,b),this.ui=new Ui({viewportClass:this.settings.viewportClass,layerClass:this.settings.layerClass,controlsClass:this.settings.controlsClass,enableControls:e.settings.enableControls}),this.model=new Model,this.controller=new Controller({buttons:e.settings.buttons})},e.build=function(){this.ui.build(d),e.currentLayer=this.ui._layer,e.controller.bindClick(function(a){e.nextLayer=e.ui.addNextLayer(e.currentLayer),e.model.loadContent(e.nextLayer,a)})},e.load=function(b){this.model.loadContent(this.ui._layer,a(e.settings.buttons[0]).attr("href"),b)},e.destroy=function(){this.ui.destroy(),this.controller.unbindClick()},e}}(jQuery),Ui.prototype.build=function(a){function b(a){return $(a).append('<div class="'+e._viewportClass+'">'),$(a).children()}function c(a){return $(a).append('<div class="'+e._layerClass+'">'),$(a).children()}function d(a){$(a).after('<div class="'+e._controlsClass+'">');var b=$(a).next();return $(b).append("<div></div><div></div>"),$(b).children()}var e=this;this._viewport=b(a),this._layer=c(this._viewport),this._enableControls&&(this._controls=d(this._layer))},Ui.prototype.addNextLayer=function(a){return $(a).after('<div class="'+this._layerClass+'">'),this._nextLayer=$(a).next(),$(this._nextLayer).hide(),this._nextLayer},Ui.prototype.destroy=function(){$(this._layer).remove(),$(this._nextLayer).remove(),$(this._viewport).remove(),$(this._controls).remove()},Model.prototype.ajaxQuery=function(a,b,c){$.ajax({url:b,dataType:"html",success:function(b){$(a).append(b)},complete:function(){"function"==typeof c&&c()}})},Model.prototype.loadContent=function(a,b,c){Model.prototype.ajaxQuery(a,b,c)},Model.prototype.changeSlides=function(){},Controller.prototype.bindClick=function(a){console.log("binding to: "+$(this._buttons)),$(this._buttons).on("click",function(b){b.preventDefault(),a($(this).attr("href"))})},Controller.prototype.unbindClick=function(){$(this._buttons).off()}(function(a){a.fn.ajaxLoader=function(b){var c={viewportClass:"tw-ajax-viewport",layerClass:"tw-ajax-layer",controlsClass:"tw-ajax-controls",buttons:".buttons",enableControls:!0,vertical:!1,selfWindow:!1,loadButton:!1,onLoadComplete:function(){console.log("Load complete! No callback.")}},d=this,e={};return e.init=function(){e.settings=a.extend({},c,b),this.viewport=new Block(e.settings.viewportClass,d),this.currentLayer=new Block(e.settings.layerClass,e.viewport._window),this.nextLayer=new Block(e.settings.layerClass,e.viewport._window),this.button=new Button(e.settings.buttons),e.build()},e.build=function(){e._currentIndex=e.button._clickedIndex;var b;b=e.settings.loadButton?a(e.settings.loadButton).attr("href"):e.button._links[0],e.currentLayer.loadContent(b,function(){a(e.viewport._window).height(e.currentLayer._height()),"function"==typeof e.settings.onLoadComplete&&e.settings.onLoadComplete()}),e.button.bindClick(function(a){e.settings.vertical&&(e.moveValue=e.viewport._height(),e.button._clickedIndex>e._currentIndex?(e.nextLayer.applyPosition("top",e.moveValue),e.nextLayer._moveDir="top",e.currentLayer._moveDir="top"):(e.nextLayer.applyPosition("top",-e.moveValue),e.nextLayer._moveDir="bottom",e.currentLayer._moveDir="bottom")),e.prevLayer=e.currentLayer,e.nextLayer.loadContent(a,function(){e.prevLayer.move(e.moveValue,function(){e.prevLayer.destroy(),"function"==typeof e.settings.onLoadComplete&&e.settings.onLoadComplete()}),e.nextLayer.move(0),e.currentLayer=e.nextLayer,e.nextLayer=new Block(e.settings.layerClass,e.viewport._window)}),e._currentIndex=e.button._clickedIndex}),e.settings.enableControls&&(this.controls=new Controls(e.settings.controlsClass,d,e.settings.links,e.settings.currentIndex),e.controls.bindClick(function(a){e.setMode(a),0==a?e.controls.currentIndex>0?e.controls.currentIndex-=1:e.controls.currentIndex=e.controls._links.length-1:e.controls.currentIndex<e.controls._links.length-1?e.controls.currentIndex+=1:e.controls.currentIndex=0,e.prevLayer=e.currentLayer,e.nextLayer.loadContent(e.controls._links[e.controls.currentIndex],function(){e.prevLayer.move(e.moveValue,function(){console.log(e.moveValue),e.prevLayer.destroy(),"function"==typeof e.settings.onLoadComplete&&e.settings.onLoadComplete()}),e.nextLayer.move(0),e.currentLayer=e.nextLayer,e.nextLayer=new Block(e.settings.layerClass,e.viewport._window)})}))},e.setControlsMode=function(a){e.settings.vertical?(e.moveValue=e.viewport._height(),0==a?(e.nextLayer.applyPosition("top",e.moveValue),e.nextLayer._moveDir="top",e.currentLayer._moveDir="top"):(e.nextLayer.applyPosition("top",-e.moveValue),e.nextLayer._moveDir="bottom",e.currentLayer._moveDir="bottom")):(e.moveValue=e.viewport._width(),0==a?(e.nextLayer.applyPosition("left",e.moveValue),e.nextLayer._moveDir="left",e.currentLayer._moveDir="left"):(e.nextLayer.applyPosition("left",-e.moveValue),e.nextLayer._moveDir="right",e.currentLayer._moveDir="right"))},e.destroy=function(){e.button.unbindClick(),e.controls.unbindClick(),a(e.viewport._window).remove(),delete e.viewport,delete e.currentLayer,delete e.nextLayer,delete e.button,delete e.controls},e}})(jQuery),Block.prototype._pos=0,Block.prototype._moveDir="",Block.prototype._height=function(){return getHeight($(this._window))},Block.prototype._width=function(){return getWidth($(this._window))},Block.prototype.applyPosition=function(a,b){var c={};c[a]=b,$(this._window).css(c)},Block.prototype.create=function(a){return $('<div class="'+this._className+'">').appendTo(a)},Block.prototype.loadContent=function(a,b){var c=this;$.ajax({url:a,dataType:"html",success:function(a){$(c._window).append(a)},complete:function(){"function"==typeof b&&b()}})},Block.prototype.move=function(a,b){var c={},d=this._moveDir;switch(d){case"top":c.top=-a;break;case"bottom":c.top=a;break;case"left":c.left=-a;break;case"right":c.left=a}$(this._window).animate(c,600,function(){"function"==typeof b&&b()})},Block.prototype._show=function(){$(this._window).fadeIn(600)},Block.prototype._hide=function(){var a=this;$(this._window).fadeOut(300,function(){a.destroy()})},Block.prototype.clear=function(a){$(this._window).children().remove(),"function"==typeof a&&a()},Block.prototype.destroy=function(){$(this._window).remove()},Button.prototype._clickedIndex=0,Button.prototype.getLinks=function(a){for(var b=[],c=0;c<a.length;c++)b.push($(a[c]).attr("href"));return b},Button.prototype.bindClick=function(a){var b,c=this;b="function"==typeof a?a:this._func,$(this._buttons).on("click",function(a){a.preventDefault(),$(c._buttons).removeClass("active"),$(this).addClass("active"),Button.prototype._clickedIndex=$(c._buttons).index($(this)),b($(this).attr("href"))})},Button.prototype.unbindClick=function(){$(this._buttons).off()},Controls.prototype.createWrapper=function(a){var b='<div class="'+this._className+'">';return $(b).appendTo(a)},Controls.prototype.createButton=function(a){return a?$('<div class="'+a+'">'+a+"</div>").appendTo($(this._wrapper)):void 0},Controls.prototype.getLinks=function(a){for(var b=[],c=0;c<a.length;c++)b.push($(a[c]).attr("href"));return b},Controls.prototype.bindClick=function(a){var b=this;$(this._buttons).on("click",function(){"function"==typeof a&&a($(b._buttons).index(this),b._links[b.currentIndex])})},Controls.prototype.unbindClick=function(){$(this._buttons).off()};